# 数据分析工具集

这是一个基于Python和PyQt6开发的数据分析工具集合，包含多个实用的数据处理模块，主要用于数据分析和格式转换。

## 功能模块

### 1. 统一入口界面
项目提供了一个统一的登录窗口，可以通过该界面访问所有功能模块：
- 三保支出进度工具
- 会计核算偏离度工具
- JSON转Excel工具

### 2. 三保支出进度工具 (sanbao_test)

该工具用于分析和计算"三保"支出进度，主要功能包括：
- 加载预算执行数据文件
- 筛选特定预算单位和三保标识类型
- 计算各类支出金额及进度百分比
- 导出分析结果到Excel文件
- 实时日志显示操作过程

#### 主要特性：
- 支持Excel数据文件导入
- 可自定义筛选条件
- 提供详细的操作日志
- 结果可导出为Excel格式

### 3. 会计核算偏离度工具 (kjhs_test)

此工具用于比较会计核算数据与预算执行数据，计算两者之间的偏离度：
- 读取预算执行数据和会计核算数据
- 处理并合并两组数据
- 计算差额和偏离度
- 识别高偏离度项目并标记
- 格式化输出结果到Excel文件

#### 主要特性：
- 支持.xls和.xlsx格式文件
- 自动跳过文件头部无关信息
- 高偏离度自动识别和标记
- 专业格式化的Excel输出
- 多线程处理避免界面冻结

### 4. JSON转Excel工具 (json_to_excel)

该工具可以将JSON格式的数据文件转换为Excel表格：
- 支持复杂嵌套结构的JSON数据
- 自动展平嵌套字段
- 处理数组类型数据
- 转换结果保存为.xlsx文件

#### 主要特性：
- 多线程后台转换，避免界面卡顿
- 进度条显示转换进度
- 支持各种JSON数据结构
- 自动生成规范的Excel文件

## 技术栈

- Python 3.14+
- PyQt6: 图形界面框架
- Pandas: 数据处理和分析
- OpenPyXL: Excel文件处理
- xlrd: 旧版Excel(.xls)文件读取
- PyInstaller: 可执行文件打包

## 安装依赖

项目使用uv作为包管理工具，可通过以下命令安装依赖：

```bash
uv pip install -r requirements.txt
```

或根据pyproject.toml安装：

```bash
uv pip install .
```

## 使用方法

运行主程序启动统一界面：

```bash
python main.py
```

然后在界面上选择需要使用的功能模块。

## 打包可执行文件

使用PyInstaller打包为独立可执行文件：

```bash
pyinstaller --onefile main.py
```

## 注意事项

1. 使用会计核算偏离度工具时，确保系统已安装xlrd库以支持.xls文件读取
2. 所有Excel文件应遵循特定格式，以便工具正确解析
3. 输出文件默认保存在程序运行目录下

## 项目结构

```
├── main.py                  # 程序入口和统一界面
├── sanbao_test/             # 三保支出分析模块
│   ├── app.py               # 主要功能实现
│   ├── constants.py         # 常量定义
│   └── gui_utils.py         # GUI工具函数
├── kjhs_test/               # 会计核算偏离度分析模块
│   └── pld_pyqt6.py         # 主要功能实现
├── json_to_excel/           # JSON转Excel模块
│   └── json_to_excel_pyqt.py # 主要功能实现
├── pyproject.toml           # 项目配置和依赖声明
└── README.md                # 项目说明文档
```